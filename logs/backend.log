
> backend-core@1.0.0 dev
> ts-node-dev --respawn --transpile-only src/index.ts

[INFO] 22:02:07 ts-node-dev ver. 2.0.0 (using ts-node ver. 10.9.2, typescript ver. 5.9.3)
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[AuthService.verifyToken] jwt.verify error: jwt malformed
[auth.middleware] Token verification failed for endpoint: /bigtech/execute
[INFO] 22:04:17 Restarting: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/config.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[auth.me.plugins] User authenticated: user-bigtech
[auth.me.plugins] User data: { id: 'user-bigtech', allowedPlugins: '["bigtech"]' }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech' ]
[auth.me.plugins] allowedPlugins: [ 'bigtech' ]
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
[auth.me.plugins] User authenticated: user-bigtech
[auth.me.plugins] User data: { id: 'user-bigtech', allowedPlugins: '["bigtech"]' }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech' ]
[auth.me.plugins] allowedPlugins: [ 'bigtech' ]
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
[admin.users] Starting list users request
[admin.users] Found 3 users in database
[admin.users] Returning formatted users
[admin.users] Starting list users request
[admin.users] Found 3 users in database
[admin.users] Returning formatted users
[auth.me.plugins] User authenticated: user-bigtech
[auth.me.plugins] User data: { id: 'user-bigtech', allowedPlugins: '["bigtech"]' }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech' ]
[auth.me.plugins] allowedPlugins: [ 'bigtech' ]
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
[auth.me.plugins] User authenticated: user-bigtech
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
[auth.me.plugins] User data: { id: 'user-bigtech', allowedPlugins: '["bigtech"]' }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech' ]
[auth.me.plugins] allowedPlugins: [ 'bigtech' ]
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
[INFO] 22:06:06 Restarting: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/config.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
âš ï¸ Falha no serviÃ§o BVSBasicaPF: Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA.
âŒ Erro na execuÃ§Ã£o BigTech: Error: Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA.
    at BigTechPlugin.normalizeResponse (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:755:13)
    at BigTechPlugin.executeWithFallbacks (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:1413:41)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:92:22)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:196:16)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:68:20
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"serviceCode":"BVSBasicaPF","cpfCnpj":"09469124677"},"success":false,"cost":0,"duration":7081,"error":"Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA."}',
  ipAddress: 'system',
  timestamp: '2025-12-27T01:06:45.115+00:00',
  '$id': '694f312520c039ab0872',
  '$permissions': [],
  '$createdAt': '2025-12-27T01:06:45.138+00:00',
  '$updatedAt': '2025-12-27T01:06:45.138+00:00',
  '$sequence': 1822,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
âš ï¸ Falha no serviÃ§o BVSBasicaPF: Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA.
âŒ Erro na execuÃ§Ã£o BigTech: Error: Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA.
    at BigTechPlugin.normalizeResponse (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:755:13)
    at BigTechPlugin.executeWithFallbacks (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:1413:41)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:92:22)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:196:16)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:68:20
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"serviceCode":"BVSBasicaPF","cpfCnpj":"09469124677"},"success":false,"cost":0,"duration":6937,"error":"Consulta falhou: A CHAVE DE ACESSO INFORMADA E USADA SOMENTE PARA HOMOLOGACAO. OPERACAO IMPEDIDA."}',
  ipAddress: 'system',
  timestamp: '2025-12-27T01:07:29.415+00:00',
  '$id': '694f3151920af4ccaa33',
  '$permissions': [],
  '$createdAt': '2025-12-27T01:07:29.599+00:00',
  '$updatedAt': '2025-12-27T01:07:29.599+00:00',
  '$sequence': 1823,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
[INFO] 22:08:57 Restarting: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/config.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[pluginAccess.middleware] MODO DESENVOLVIMENTO: Permitindo acesso ao plugin: bigtech
âŒ Erro na execuÃ§Ã£o BigTech: RangeError: Invalid time value
    at Date.toISOString (<anonymous>)
    at Function.normalizeOutput (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/validator.ts:550:59)
    at Validator.normalizeOutput (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/validator.ts:86:33)
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:95:45)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:196:16)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:68:20
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"serviceCode":"BVSBasicaPF","cpfCnpj":"09469124677","tipoPessoa":"F"},"success":false,"cost":0,"duration":8056,"error":"Invalid time value"}',
  ipAddress: 'system',
  timestamp: '2025-12-27T01:11:06.529+00:00',
  '$id': '694f322c80545b5891dc',
  '$permissions': [],
  '$createdAt': '2025-12-27T01:11:08.526+00:00',
  '$updatedAt': '2025-12-27T01:11:08.526+00:00',
  '$sequence': 1824,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
[admin.users] Starting list users request
[admin.users] Found 3 users in database
[admin.users] Returning formatted users
[admin.users] Starting list users request
[admin.users] Found 3 users in database
[admin.users] Returning formatted users
[INFO] 22:11:58 Restarting: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/config.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
