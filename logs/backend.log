
> backend-core@1.0.0 dev
> ts-node-dev --respawn --transpile-only src/index.ts

[INFO] 18:40:48 ts-node-dev ver. 2.0.0 (using ts-node ver. 10.9.2, typescript ver. 5.9.3)
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[INFO] 18:41:58 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
Error: listen EADDRINUSE: address already in use :::8080
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/home/mau/projeto/consulta/backend/node_modules/express/lib/application.js:635:24)
    at /home/mau/projeto/consulta/backend/src/index.ts:124:9
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
[ERROR] 18:41:58 Error: listen EADDRINUSE: address already in use :::8080
[INFO] 18:42:04 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
[auth.login] MODO TESTE: Pulando validaÃ§Ã£o do Appwrite Accounts
[auth.login] Criando usuÃ¡rio automaticamente para: test@example.com
Erro ao criar tenant automaticamente: AppwriteException: Invalid document structure: Missing required attribute "createdAt"
    at _Client.call (/home/mau/projeto/consulta/backend/node_modules/node-appwrite/src/client.ts:370:12)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at Function.ensureTenantExists (/home/mau/projeto/consulta/backend/src/core/auth.ts:292:11)
    at /home/mau/projeto/consulta/backend/src/core/auth.ts:844:11 {
  code: 400,
  type: 'document_invalid_structure',
  response: '{"message":"Invalid document structure: Missing required attribute \\"createdAt\\"","code":400,"type":"document_invalid_structure","version":"1.8.0"}'
}
[auth.login] Erro ao acessar banco de dados: AppwriteException: Invalid document structure: Missing required attribute "createdAt"
    at _Client.call (/home/mau/projeto/consulta/backend/node_modules/node-appwrite/src/client.ts:370:12)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at Function.ensureTenantExists (/home/mau/projeto/consulta/backend/src/core/auth.ts:292:11)
    at /home/mau/projeto/consulta/backend/src/core/auth.ts:844:11 {
  code: 400,
  type: 'document_invalid_structure',
  response: '{"message":"Invalid document structure: Missing required attribute \\"createdAt\\"","code":400,"type":"document_invalid_structure","version":"1.8.0"}'
}
[auth.login] MODO TESTE: Pulando validaÃ§Ã£o do Appwrite Accounts
[auth.login] Criando usuÃ¡rio automaticamente para: test@example.com
Erro ao criar tenant automaticamente: AppwriteException: Invalid document structure: Missing required attribute "createdAt"
    at _Client.call (/home/mau/projeto/consulta/backend/node_modules/node-appwrite/src/client.ts:370:12)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at Function.ensureTenantExists (/home/mau/projeto/consulta/backend/src/core/auth.ts:292:11)
    at /home/mau/projeto/consulta/backend/src/core/auth.ts:844:11 {
  code: 400,
  type: 'document_invalid_structure',
  response: '{"message":"Invalid document structure: Missing required attribute \\"createdAt\\"","code":400,"type":"document_invalid_structure","version":"1.8.0"}'
}
[auth.login] Erro ao acessar banco de dados: AppwriteException: Invalid document structure: Missing required attribute "createdAt"
    at _Client.call (/home/mau/projeto/consulta/backend/node_modules/node-appwrite/src/client.ts:370:12)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at Function.ensureTenantExists (/home/mau/projeto/consulta/backend/src/core/auth.ts:292:11)
    at /home/mau/projeto/consulta/backend/src/core/auth.ts:844:11 {
  code: 400,
  type: 'document_invalid_structure',
  response: '{"message":"Invalid document structure: Missing required attribute \\"createdAt\\"","code":400,"type":"document_invalid_structure","version":"1.8.0"}'
}
[auth.login] MODO TESTE: Pulando validaÃ§Ã£o do Appwrite Accounts
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'user_login',
  resource: 'user:user-bigtech',
  details: '{"email":"user@bigtech.com"}',
  ipAddress: 'system',
  timestamp: '2025-12-26T21:43:25.701+00:00',
  '$id': '694f017dc979ea7a1058',
  '$permissions': [],
  '$createdAt': '2025-12-26T21:43:25.825+00:00',
  '$updatedAt': '2025-12-26T21:43:25.825+00:00',
  '$sequence': 1781,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
[INFO] 18:43:44 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ›‘ Shutting down CORE...
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
Error: listen EADDRINUSE: address already in use :::8080
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/home/mau/projeto/consulta/backend/node_modules/express/lib/application.js:635:24)
    at /home/mau/projeto/consulta/backend/src/index.ts:124:9
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
[ERROR] 18:43:45 Error: listen EADDRINUSE: address already in use :::8080
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [INFO] 18:41:58 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
Error: listen EADDRINUSE: address already in use :::8080
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/home/mau/projeto/consulta/backend/node_modules/express/lib/application.js:635:24)
    at /home/mau/projeto/consulta/backend/src/index.ts:124:9
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
[ERROR] 18:41:58 Error: listen EADDRINUSE: address already in use :::8080
[INFO] 18:42:04 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
Error: listen EADDRINUSE: address already in use :::8080
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/home/mau/projeto/consulta/backend/node_modules/express/lib/application.js:635:24)
    at /home/mau/projeto/consulta/backend/src/index.ts:124:9
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
[ERROR] 18:42:05 Error: listen EADDRINUSE: address already in use :::8080
[INFO] 18:43:44 Restarting: /home/mau/projeto/consulta/backend/src/controllers/plugins.ts has been modified
ğŸ‘‚ Handler subscribed to event: query.executed
ğŸ‘‚ Handler subscribed to event: credits.purchased
ğŸ’° Billing Engine initialized
ğŸ“¡ Event Bus initialized
ğŸ” Found plugin types: [ 'consulta', 'pagamentos' ]
ğŸ” Found plugins in consulta: [ 'bigtech', 'infosimples' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts
ğŸ”„ Importing plugin: consulta-bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
Error: listen EADDRINUSE: address already in use :::8080
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/home/mau/projeto/consulta/backend/node_modules/express/lib/application.js:635:24)
    at /home/mau/projeto/consulta/backend/src/index.ts:124:9
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
[ERROR] 18:43:45 Error: listen EADDRINUSE: address already in use :::8080
bigtech
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
âœ… Plugin validation passed for: bigtech
âœ… Plugin loaded: consulta-bigtech v1.0.0
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/consulta/infosimples/index.ts
ğŸ”„ Importing plugin: consulta-infosimples
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
âœ… Plugin validation passed for: infosimples
âœ… Plugin loaded: consulta-infosimples v1.0.0
ğŸ” Found plugins in pagamentos: [ 'asaas' ]
ğŸ” Checking plugin path: /home/mau/projeto/consulta/backend/src/plugins/pagamentos/asaas/index.ts
ğŸ”„ Importing plugin: pagamentos-asaas
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
âœ… Plugin validation passed for: pagamento-asaas
âœ… Plugin loaded: pagamentos-asaas v1.0.0
[DEV] Skipping active plugins load from database
âœ… Plugins infosimples e bigtech ativados por padrÃ£o para tenant default
ğŸ“¡ Event Bus initialized
ğŸ’° Billing Engine initialized
âœ… CORE initialized successfully
ğŸš€ BigTech CORE running on port 8080
ğŸ“Š Health check: http://localhost:8080/health
âŒ Erro na execuÃ§Ã£o BigTech: Error: serviceCode Ã© obrigatÃ³rio
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:82:15)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:201:29)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:69:39
    at Layer.handle [as handle_request] (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/route.js:149:13)
    at /home/mau/projeto/consulta/backend/src/middleware/pluginAccess.ts:61:7
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"cpf":"[REDACTED]"},"success":false,"cost":0,"duration":78,"error":"serviceCode Ã© obrigatÃ³rio"}',
  ipAddress: 'system',
  timestamp: '2025-12-26T21:43:47.801+00:00',
  '$id': '694f0193d653ac63b2f4',
  '$permissions': [],
  '$createdAt': '2025-12-26T21:43:47.878+00:00',
  '$updatedAt': '2025-12-26T21:43:47.878+00:00',
  '$sequence': 1782,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
âŒ Erro na execuÃ§Ã£o BigTech: ValidationError: NomeCompleto Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres
    at Validator.validateInput (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/validator.ts:78:13)
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:86:22)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:201:29)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:69:39
    at Layer.handle [as handle_request] (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/route.js:149:13)
    at /home/mau/projeto/consulta/backend/src/middleware/pluginAccess.ts:61:7
    at processTicksAndRejections (node:internal/process/task_queues:95:5) {
  field: 'input'
}
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"serviceCode":"36-busca-nome-uf","nome":"JoÃ£o Silva","uf":"SP"},"success":false,"cost":0,"duration":4,"error":"NomeCompleto Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres"}',
  ipAddress: 'system',
  timestamp: '2025-12-26T21:43:52.006+00:00',
  '$id': '694f019803fea347f664',
  '$permissions': [],
  '$createdAt': '2025-12-26T21:43:52.016+00:00',
  '$updatedAt': '2025-12-26T21:43:52.016+00:00',
  '$sequence': 1783,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
[auth.me.plugins] User authenticated: user-bigtech
[auth.me.plugins] User data: {
  id: 'user-bigtech',
  tenantId: 'default',
  allowedPlugins: '["bigtech","infosimples"]'
}
[auth.me.plugins] Tenant data: { id: 'default', plugins: [ 'bigtech' ] }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech', 'infosimples' ]
[auth.me.plugins] allowedPlugins: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] Searching for plugin infosimples in database
[auth.me.plugins] Found 0 documents for plugin infosimples
[auth.me.plugins] No documents found for plugin infosimples, returning mock data
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'infosimples',
    name: 'infosimples',
    type: 'consulta',
    config: {}
  },
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
[auth.me.plugins] User authenticated: user-bigtech
[auth.me.plugins] User data: {
  id: 'user-bigtech',
  tenantId: 'default',
  allowedPlugins: '["bigtech","infosimples"]'
}
[auth.me.plugins] Tenant data: { id: 'default', plugins: [ 'bigtech' ] }
[auth.me.plugins] activeTenantPluginIds from pluginLoader: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] userAllowedPlugins: [ 'bigtech', 'infosimples' ]
[auth.me.plugins] allowedPlugins: [ 'infosimples', 'bigtech' ]
[auth.me.plugins] Searching for plugin infosimples in database
[auth.me.plugins] Found 0 documents for plugin infosimples
[auth.me.plugins] No documents found for plugin infosimples, returning mock data
[auth.me.plugins] Searching for plugin bigtech in database
[auth.me.plugins] Found 0 documents for plugin bigtech
[auth.me.plugins] No documents found for plugin bigtech, returning mock data
[auth.me.plugins] pluginsDetails: [
  {
    id: 'infosimples',
    name: 'infosimples',
    type: 'consulta',
    config: {}
  },
  {
    id: 'bigtech',
    name: 'BigTech Consultas',
    type: 'consulta',
    config: {}
  }
]
âŒ Erro na execuÃ§Ã£o BigTech: ValidationError: NomeCompleto Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres
    at Validator.validateInput (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/validator.ts:78:13)
    at BigTechPlugin.execute (/home/mau/projeto/consulta/backend/src/plugins/consulta/bigtech/index.ts:86:22)
    at PluginLoader.executePlugin (/home/mau/projeto/consulta/backend/src/core/pluginLoader.ts:201:29)
    at /home/mau/projeto/consulta/backend/src/controllers/plugins.ts:69:39
    at Layer.handle [as handle_request] (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/mau/projeto/consulta/backend/node_modules/express/lib/router/route.js:149:13)
    at /home/mau/projeto/consulta/backend/src/middleware/pluginAccess.ts:61:7
    at processTicksAndRejections (node:internal/process/task_queues:95:5) {
  field: 'input'
}
AuditLogger: created audit document {
  tenantId: 'default',
  userId: 'user-bigtech',
  action: 'plugin_execute',
  resource: 'plugin:bigtech',
  details: '{"pluginId":"bigtech","input":{"serviceCode":"36-busca-nome-uf","nome":"JoÃ£o Silva Santos","uf":"SP"},"success":false,"cost":0,"duration":3,"error":"NomeCompleto Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres"}',
  ipAddress: 'system',
  timestamp: '2025-12-26T21:44:03.066+00:00',
  '$id': '694f01a314d495dafc45',
  '$permissions': [],
  '$createdAt': '2025-12-26T21:44:03.085+00:00',
  '$updatedAt': '2025-12-26T21:44:03.085+00:00',
  '$sequence': 1784,
  '$databaseId': 'bigtechdb',
  '$collectionId': 'audits'
}
