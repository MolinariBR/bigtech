(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{4764:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return a(9461)}])},6691:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6815:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9461:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return E}});var i=a(5893),t=a(7294),r=a(8778),l=a(9346),n=a(2378),c=a(4109),d=a(5305),o=a(8860),h=a(1538),u=a(4350),x=a(1519),j=a(4940),m=a(641),p=a(4270),f=a(300),v=a(6815),N=a(1552),w=a(1743),g=a(7864),y=a(8267),C=a(6691),k=a(4712);function E(){let[e,s]=(0,t.useState)([]),[a,E]=(0,t.useState)(!0),[S,A]=(0,t.useState)(null),[T,Z]=(0,t.useState)(null),[_,b]=(0,t.useState)(!1),[z,F]=(0,t.useState)(!1),[$,I]=(0,t.useState)(null),[U,P]=(0,t.useState)(null),D=async()=>{try{E(!0);let e=localStorage.getItem("accessToken"),a=await fetch("http://localhost:8080/api/admin/users",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok)throw Error("Failed to load users");let i=await a.json();s(i.users||[])}catch(e){A(e instanceof Error?e.message:"Unknown error")}finally{E(!1)}};(0,t.useEffect)(()=>{D()},[]);let O=e=>{Z(e),b(!0)},B=async()=>{if(T)try{F(!0);let e=localStorage.getItem("accessToken");if(!(await fetch("http://localhost:8080/api/admin/users/".concat(T.id),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({email:T.email,role:T.role,status:T.status})})).ok)throw Error("Failed to update user");k.Am.success("Usu\xe1rio atualizado com sucesso"),b(!1),Z(null),D()}catch(e){k.Am.error("Erro ao atualizar usu\xe1rio")}finally{F(!1)}},V=async(e,s)=>{try{I(e);let a=localStorage.getItem("accessToken"),i="active"===s?"inactive":"active";if(!(await fetch("http://localhost:8080/api/admin/users/".concat(e,"/status"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({status:i})})).ok)throw Error("Failed to update user status");k.Am.success("Usu\xe1rio ".concat("active"===i?"ativado":"desativado"," com sucesso")),D()}catch(e){k.Am.error("Erro ao alterar status do usu\xe1rio")}finally{I(null)}},Q=async e=>{try{let s=localStorage.getItem("accessToken");if(!(await fetch("http://localhost:8080/api/admin/users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}})).ok)throw Error("Failed to delete user");k.Am.success("Usu\xe1rio exclu\xeddo com sucesso"),P(null),D()}catch(e){k.Am.error("Erro ao excluir usu\xe1rio")}},X=e=>{let s=e.replace(/\D/g,"");return 11===s.length?s.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):14===s.length?s.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):e};return a?(0,i.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,i.jsx)(m.Z,{className:"h-8 w-8 animate-spin"})}):S?(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsxs)("p",{className:"text-red-500",children:["Erro ao carregar usu\xe1rios: ",S]}),(0,i.jsx)(r.z,{onClick:D,className:"mt-4",children:"Tentar novamente"})]}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"Gerenciar Usu\xe1rios"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Gerencie usu\xe1rios do sistema frontend-app"})]}),(0,i.jsxs)(r.z,{children:[(0,i.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Novo Usu\xe1rio"]})]}),(0,i.jsxs)(l.Zb,{children:[(0,i.jsx)(l.Ol,{children:(0,i.jsxs)(l.ll,{children:["Usu\xe1rios (",e.length,")"]})}),(0,i.jsxs)(l.aY,{children:[(0,i.jsxs)(n.iA,{children:[(0,i.jsx)(n.xD,{children:(0,i.jsxs)(n.SC,{children:[(0,i.jsx)(n.ss,{children:"Identificador"}),(0,i.jsx)(n.ss,{children:"Nome"}),(0,i.jsx)(n.ss,{children:"Email"}),(0,i.jsx)(n.ss,{children:"Telefone"}),(0,i.jsx)(n.ss,{children:"Tenant"}),(0,i.jsx)(n.ss,{children:"Status"}),(0,i.jsx)(n.ss,{children:"Cr\xe9ditos"}),(0,i.jsx)(n.ss,{children:"A\xe7\xf5es"})]})}),(0,i.jsx)(n.RM,{children:e.map(e=>(0,i.jsxs)(n.SC,{children:[(0,i.jsx)(n.pj,{className:"font-mono",children:X(e.identifier)}),(0,i.jsx)(n.pj,{children:e.name||"-"}),(0,i.jsx)(n.pj,{children:e.email||"-"}),(0,i.jsx)(n.pj,{children:e.phone||"-"}),(0,i.jsx)(n.pj,{children:(0,i.jsx)(c.C,{variant:"outline",children:e.tenantId})}),(0,i.jsx)(n.pj,{children:(0,i.jsx)(c.C,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Ativo":"Inativo"})}),(0,i.jsx)(n.pj,{children:e.credits}),(0,i.jsx)(n.pj,{children:(0,i.jsxs)(j.h_,{children:[(0,i.jsx)(j.$F,{asChild:!0,children:(0,i.jsx)(r.z,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,i.jsx)(f.Z,{className:"h-4 w-4"})})}),(0,i.jsxs)(j.AW,{align:"end",children:[(0,i.jsx)(j.Ju,{children:"A\xe7\xf5es"}),(0,i.jsxs)(j.Xi,{onClick:()=>O(e),children:[(0,i.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,i.jsx)(j.VD,{}),(0,i.jsxs)(j.Xi,{onClick:()=>V(e.id,e.status),disabled:$===e.id,children:[$===e.id?(0,i.jsx)(m.Z,{className:"h-4 w-4 mr-2 animate-spin"}):"active"===e.status?(0,i.jsx)(N.Z,{className:"h-4 w-4 mr-2"}):(0,i.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"active"===e.status?"Desativar":"Ativar"]}),(0,i.jsx)(j.VD,{}),(0,i.jsxs)(x.aR,{children:[(0,i.jsx)(x.vW,{asChild:!0,children:(0,i.jsxs)(j.Xi,{className:"text-red-600",onSelect:e=>e.preventDefault(),children:[(0,i.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Excluir"]})}),(0,i.jsxs)(x._T,{children:[(0,i.jsxs)(x.fY,{children:[(0,i.jsx)(x.f$,{children:"Confirmar exclus\xe3o"}),(0,i.jsxs)(x.yT,{children:["Tem certeza que deseja excluir o usu\xe1rio ",X(e.identifier),"? Esta a\xe7\xe3o n\xe3o pode ser desfeita."]})]}),(0,i.jsxs)(x.xo,{children:[(0,i.jsx)(x.le,{children:"Cancelar"}),(0,i.jsx)(x.OL,{onClick:()=>Q(e.id),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})]})]})]})})]},e.id))})]}),0===e.length&&(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)(y.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Nenhum usu\xe1rio encontrado"})]})]})]}),(0,i.jsx)(d.Vq,{open:_,onOpenChange:b,children:(0,i.jsxs)(d.cZ,{className:"sm:max-w-[425px]",children:[(0,i.jsx)(d.fK,{children:(0,i.jsx)(d.$N,{children:"Editar Usu\xe1rio"})}),T&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(h._,{htmlFor:"identifier",children:"Identificador (CPF/CNPJ)"}),(0,i.jsx)(o.I,{id:"identifier",value:X(T.identifier),disabled:!0,className:"bg-muted"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h._,{htmlFor:"email",children:"Email"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(C.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,i.jsx)(o.I,{id:"email",type:"email",value:T.email||"",onChange:e=>Z({...T,email:e.target.value}),placeholder:"email@exemplo.com",className:"pl-10"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h._,{htmlFor:"role",children:"Fun\xe7\xe3o"}),(0,i.jsxs)(u.Ph,{value:T.role,onValueChange:e=>Z({...T,role:e}),children:[(0,i.jsx)(u.i4,{children:(0,i.jsx)(u.ki,{})}),(0,i.jsxs)(u.Bw,{children:[(0,i.jsx)(u.Ql,{value:"viewer",children:"Visualizador"}),(0,i.jsx)(u.Ql,{value:"user",children:"Usu\xe1rio"}),(0,i.jsx)(u.Ql,{value:"admin",children:"Administrador"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h._,{htmlFor:"status",children:"Status"}),(0,i.jsxs)(u.Ph,{value:T.status,onValueChange:e=>Z({...T,status:e}),children:[(0,i.jsx)(u.i4,{children:(0,i.jsx)(u.ki,{})}),(0,i.jsxs)(u.Bw,{children:[(0,i.jsx)(u.Ql,{value:"active",children:"Ativo"}),(0,i.jsx)(u.Ql,{value:"inactive",children:"Inativo"})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,i.jsx)(r.z,{variant:"outline",onClick:()=>b(!1),disabled:z,children:"Cancelar"}),(0,i.jsx)(r.z,{onClick:B,disabled:z,children:z?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar"})]})]})]})})]})}}},function(e){e.O(0,[914,313,336,888,774,179],function(){return e(e.s=4764)}),_N_E=e.O()}]);