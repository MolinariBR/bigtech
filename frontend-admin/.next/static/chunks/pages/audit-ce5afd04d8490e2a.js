(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[718],{1841:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/audit",function(){return a(8568)}])},9671:function(e,t,a){"use strict";a.d(t,{Ol:function(){return d},Zb:function(){return n},aY:function(){return c},ll:function(){return i}});var r=a(4246),s=a(7378),l=a(4456);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...s})});d.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},1651:function(e,t,a){"use strict";a.d(t,{I:function(){return n}});var r=a(4246),s=a(7378),l=a(4456);let n=s.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});n.displayName="Input"},2833:function(e,t,a){"use strict";a.d(t,{Bw:function(){return m},Ph:function(){return c},Ql:function(){return j},i4:function(){return f},ki:function(){return u}});var r=a(4246),s=a(7378),l=a(6252),n=a(5709),d=a(8927),i=a(1759),o=a(4456);let c=l.fC;l.ZA;let u=l.B4,f=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(l.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...d,children:[s,(0,r.jsx)(l.JO,{asChild:!0,children:(0,r.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=l.xz.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})});p.displayName=l.u_.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})});x.displayName=l.$G.displayName;let m=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...d}=e;return(0,r.jsx)(l.h_,{children:(0,r.jsxs)(l.VY,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...d,children:[(0,r.jsx)(p,{}),(0,r.jsx)(l.l_,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(x,{})]})})});m.displayName=l.VY.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})});h.displayName=l.__.displayName;let j=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(l.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.wU,{children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(l.eT,{children:s})]})});j.displayName=l.ck.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});g.displayName=l.Z0.displayName},4172:function(e,t,a){"use strict";a.d(t,{RM:function(){return i},SC:function(){return c},iA:function(){return n},pj:function(){return f},ss:function(){return u},xD:function(){return d}});var r=a(4246),s=a(7378),l=a(4456);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",a),...s})})});n.displayName="Table";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...s})});d.displayName="TableHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...s})});i.displayName="TableBody";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})});o.displayName="TableFooter";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});c.displayName="TableRow";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...s})});u.displayName="TableHead";let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});f.displayName="TableCell";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...s})});p.displayName="TableCaption"},8568:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return AuditPage}});var r=a(4246),s=a(7378),l=a(9671),n=a(1810),d=a(1651),i=a(2833),o=a(4172),modal=e=>{let{isOpen:t,onClose:a,children:s}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full mx-4 p-4",children:[(0,r.jsx)("button",{onClick:a,className:"float-right text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"\xd7"}),s]})}):null},c=a(5405);let u=new c.KU().setEndpoint("https://cloud.appwrite.io/v1").setProject("your-project-id"),f=new c.Lg(u);new c.mR(u);var p=a(4284);function AuditPage(){let[e,t]=(0,s.useState)([]),[a,u]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),[h,j]=(0,s.useState)({tenantId:"",userId:"",action:"",resource:"",startDate:null,endDate:null});(0,s.useEffect)(()=>{fetchLogs()},[h]);let fetchLogs=async()=>{u(!0);try{let e=[];h.tenantId&&e.push(c.AE.equal("tenantId",h.tenantId)),h.userId&&e.push(c.AE.equal("userId",h.userId)),h.action&&e.push(c.AE.equal("action",h.action)),h.resource&&e.push(c.AE.equal("resource",h.resource)),h.startDate&&e.push(c.AE.greaterThanEqual("timestamp",h.startDate.toISOString())),h.endDate&&e.push(c.AE.lessThanEqual("timestamp",h.endDate.toISOString()));let a=await f.listDocuments(p.env.NEXT_PUBLIC_APPWRITE_DATABASE_ID||"bigtechdb","audits",e);t(a.documents)}catch(e){console.error("Failed to fetch audit logs:",e)}finally{u(!1)}},handleExport=async()=>{let t=e.map(e=>"".concat(e.timestamp,",").concat(e.action,",").concat(e.resource,",").concat(e.ipAddress)).join("\n"),a=new Blob([t],{type:"text/csv"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="audit-logs.csv",s.click()};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Auditoria de A\xe7\xf5es"})}),(0,r.jsxs)(l.aY,{children:[(0,r.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,r.jsx)(d.I,{placeholder:"Tenant ID",value:h.tenantId,onChange:e=>j({...h,tenantId:e.target.value})}),(0,r.jsx)(d.I,{placeholder:"User ID",value:h.userId,onChange:e=>j({...h,userId:e.target.value})}),(0,r.jsxs)(i.Ph,{value:h.action||"all",onValueChange:e=>j({...h,action:"all"===e?"":e}),children:[(0,r.jsx)(i.i4,{children:(0,r.jsx)(i.ki,{placeholder:"Todas as a\xe7\xf5es"})}),(0,r.jsxs)(i.Bw,{children:[(0,r.jsx)(i.Ql,{value:"all",children:"Todas as a\xe7\xf5es"}),(0,r.jsx)(i.Ql,{value:"consulta_executada",children:"Consulta Executada"}),(0,r.jsx)(i.Ql,{value:"plugin_enabled",children:"Plugin Habilitado"})]})]}),(0,r.jsx)(d.I,{type:"date",value:h.startDate?h.startDate.toISOString().split("T")[0]:"",onChange:e=>j({...h,startDate:e.target.value?new Date(e.target.value):null}),placeholder:"Data inicial"}),(0,r.jsx)(d.I,{type:"date",value:h.endDate?h.endDate.toISOString().split("T")[0]:"",onChange:e=>j({...h,endDate:e.target.value?new Date(e.target.value):null}),placeholder:"Data final"}),(0,r.jsx)(n.z,{onClick:handleExport,children:"Exportar"})]}),(0,r.jsxs)(o.iA,{children:[(0,r.jsx)(o.xD,{children:(0,r.jsxs)(o.SC,{children:[(0,r.jsx)(o.pj,{children:"Timestamp"}),(0,r.jsx)(o.pj,{children:"Tenant"}),(0,r.jsx)(o.pj,{children:"User"}),(0,r.jsx)(o.pj,{children:"Action"}),(0,r.jsx)(o.pj,{children:"Resource"}),(0,r.jsx)(o.pj,{children:"IP"}),(0,r.jsx)(o.pj,{children:"A\xe7\xf5es"})]})}),(0,r.jsx)(o.RM,{children:e.map(e=>(0,r.jsxs)(o.SC,{children:[(0,r.jsx)(o.pj,{children:new Date(e.timestamp).toLocaleString()}),(0,r.jsx)(o.pj,{children:e.tenantId}),(0,r.jsx)(o.pj,{children:e.userId||"-"}),(0,r.jsx)(o.pj,{children:e.action}),(0,r.jsx)(o.pj,{children:e.resource}),(0,r.jsx)(o.pj,{children:e.ipAddress}),(0,r.jsx)(o.pj,{children:(0,r.jsx)(n.z,{onClick:()=>m(e),children:"Detalhes"})})]},e.id))})]})]})]}),x&&(0,r.jsxs)(modal,{isOpen:!0,onClose:()=>m(null),children:[(0,r.jsx)("h3",{children:"Detalhes do Log"}),(0,r.jsx)("pre",{children:JSON.stringify(JSON.parse(x.details),null,2)})]})]})}}},function(e){e.O(0,[619,983,774,888,179],function(){return e(e.s=1841)}),_N_E=e.O()}]);