(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[67],{6570:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/billing",function(){return t(468)}])},468:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return BillingPage}});var i=t(4246),a=t(7378);function BillingPage(){let[e,n]=a.useState([]),[t,d]=a.useState(!1),[s,l]=a.useState(1);async function fetchList(){d(!0);try{let e=await fetch("/api/admin/billing?page=".concat(s,"&perPage=20")),t=await e.json();n(t.items||[])}catch(e){console.error(e)}finally{d(!1)}}async function handleExport(){let e=await fetch("/api/admin/billing/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),n=await e.json();alert("Export job submitted: ".concat(n.jobId))}async function handleRefund(e){let n="audit_".concat(Date.now()),t=await fetch("/api/admin/billing/".concat(e,"/refund"),{method:"POST",headers:{"Content-Type":"application/json","X-Audit-Id":n},body:JSON.stringify({reason:"Admin refund"})}),i=await t.json();t.ok?(alert("Refund created: "+i.refundId),fetchList()):alert("Refund failed: "+(i.error||"unknown"))}return a.useEffect(()=>{fetchList()},[s]),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Monitoramento de Billing"}),(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:handleExport,disabled:t,children:"Exportar"})}),t?(0,i.jsx)("div",{children:"Carregando..."}):(0,i.jsxs)("table",{className:"min-w-full bg-white",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ID"}),(0,i.jsx)("th",{children:"Tenant"}),(0,i.jsx)("th",{children:"User"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Amount"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"A\xe7\xf5es"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.$id}),(0,i.jsx)("td",{children:e.tenantId}),(0,i.jsx)("td",{children:e.userId}),(0,i.jsx)("td",{children:e.type}),(0,i.jsx)("td",{children:e.amount}),(0,i.jsx)("td",{children:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{className:"px-2 py-1 bg-red-600 text-white rounded",onClick:()=>handleRefund(e.$id),children:"Reembolsar"})})]},e.$id))})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("button",{className:"px-3 py-1 mr-2 bg-gray-200",onClick:()=>l(e=>Math.max(1,e-1)),children:"Anterior"}),(0,i.jsx)("button",{className:"px-3 py-1 bg-gray-200",onClick:()=>l(e=>e+1),children:"Pr\xf3xima"})]})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=6570)}),_N_E=e.O()}]);