# Projeto Bigtech — Páginas e Interfaces (Pages)

## Índice dos Documentos

- [1.Project.md](1.Project.md) - Visão geral do projeto
- [2.Architecture.md](2.Architecture.md) - Arquitetura técnica
- [3.Structure.md](3.Structure.md) - Estrutura do projeto
- [4.Entities.md](4.Entities.md) - Modelos de dados (entidades)
- [5.Pages.md](5.Pages.md) - Páginas e interfaces
- [6.UserStories.md](6.UserStories.md) - User Stories
- [7.Tasks.md](7.Tasks.md) - Tasks de implementação
- [8.DesignSystem.md](8.DesignSystem.md) - Design System

## 1. Descrição Geral

Este documento detalha as páginas e interfaces dos frontends do Projeto Bigtech: **Frontend-User** (app.bigtech.com.br) para usuários finais e **Frontend-Admin** (admin.bigtech.com.br) para administradores. As páginas são implementadas em Next.js (React), com foco em UX intuitiva, isolamento multi-tenant e integração com o CORE via APIs. Elas exibem dados das entidades (ex.: Consulta, Billing) e interagem com plugins ativos, garantindo extensibilidade.

O design segue princípios de responsividade, acessibilidade e temas (dark/light), alinhados com a arquitetura SaaS e estrutura de diretórios. Páginas são autenticadas via JWT, com redirecionamento automático baseado em role (user/admin).

## 2. Estrutura de Páginas

### 2.1 Frontend-app (app.bigtech.com.br)
Páginas organizadas em `frontend-user/src/pages/`, focadas em consultas e gestão pessoal. Inclui componentes comuns: Header (navegação superior), Footer (copyright e links), Sidebar (menu lateral com links para Principal, Consultas, Relatórios, Financeiro, Aviso LGPD).

- **/** (index.tsx): Dashboard principal (Página Principal).
- **/consulta/credito** (consulta/credito.tsx): Página de consultas de crédito.
- **/consulta/cadastral** (consulta/cadastral.tsx): Página de consultas cadastrais.
- **/consulta/veicular** (consulta/veicular.tsx): Página de consultas veiculares.
- **/relatorios/consultas** (relatorios/consultas.tsx): Relatório de consumo de consultas.
- **/financeiro/extrato** (financeiro/extrato.tsx): Extrato financeiro.
- **/financeiro/comprar** (financeiro/comprar.tsx): Compra de créditos.
- **/financeiro/boletos** (financeiro/boletos.tsx): Boletos e faturas.
- **/lgpd** (lgpd.tsx): Aviso LGPD.
- **/_app.tsx**: Wrapper global com autenticação e tema.

### 2.2 Frontend-Admin (admin.bigtech.com.br)
Páginas organizadas em `frontend-admin/src/pages/`, focadas em gestão operacional.

- **/** (index.tsx): Dashboard administrativo.
- **/tenants** (tenants.tsx): Gestão de tenants.
- **/plugins** (plugins.tsx): Gestão de plugins.
- **/billing** (billing.tsx): Monitoramento de billing.
- **/audit** (audit.tsx): Auditoria de ações.
- **/_app.tsx**: Wrapper global com autenticação e permissões.

## 3. Funcionalidades Principais

### 3.1 Frontend-User
- **Dashboard (/)**: Exibe cards superiores (saldo disponível, saldo anterior, saldo bloqueado, última atualização), cards secundários para acesso rápido a consultas (crédito, cadastral, veicular), e tabela com últimas consultas realizadas. Componentes: Card para métricas, Button para ações.
- **Consulta Crédito (/consulta/credito)**: Página com cards exibindo opções de consultas de crédito disponíveis via plugins ativos (ex.: POSITIVO ACERTA ESSENCIAL PF, PROTESTO SINTÉTICO NACIONAL). Cada card inclui preço, descrição e botão para executar. Validação de créditos e fallback automático.
- **Consulta Cadastral (/consulta/cadastral)**: Similar, com cards para consultas cadastrais (ex.: QUOD CADASTRAL PF, RELATÓRIO JURIDICO PF). Integração com plugins para dados de identidade e processos.
- **Consulta Veicular (/consulta/veicular)**: Cards para consultas veiculares (ex.: BIN NACIONAL COMPLETA, CRLV por estado). Suporte a documentos específicos por estado.
- **Relatórios (/relatorios/consultas)**: Relatório de consumo de consultas, com filtros e exportação. Baseado em entidade Consulta.
- **Financeiro (/financeiro/extrato)**: Extrato de transações (entidade Billing), com detalhes de débitos/créditos.
- **Comprar Créditos (/financeiro/comprar)**: Página de seleção de valor de créditos (modelo pré-pago), com input para quantidade desejada, validação de valores mínimos/máximos (configuráveis via frontend-admin), cálculo automático do total, integração com plugin de pagamento. Atualiza User.credits após confirmação. Componentes: Input para valor, Button para confirmar, Modal para revisão e pagamento.
- **Boletos/Faturas (/financeiro/boletos)**: Lista de boletos pendentes/pagos, com links para download.
- **Aviso LGPD (/lgpd)**: Página com informações de privacidade e consentimento.

### 3.2 Frontend-Admin
- **Dashboard (/)**: Métricas globais (ex.: tenants ativos, consumo total via Billing), gráficos de uso, alertas. Componentes: Charts para visualização, TenantManager para overview.
- **Tenants (/tenants)**: Lista de tenants (entidade Tenant), criação/editação (formulários), ativação/desativação. Filtros por status, isolamento visual por tenant.
- **Plugins (/plugins)**: Lista de plugins disponíveis/ativos por tenant (entidade Plugin), toggles para enable/disable, configuração (ex.: fallbackSources). Validação de dependências.
- **Billing (/billing)**: Relatórios de transações (entidade Billing), filtros por tenant/usuário, exportação. Integração com plugins de pagamento para reembolsos.

## 4. Fluxo de Navegação

### 4.1 Frontend-User
1. **Login/Redirecionamento**: Usuário acessa app.bigtech.com.br, autentica via CPF/CNPJ (CORE), redireciona para /.
2. **Navegação Principal**: Sidebar com links para seções (Principal, Consultas, Relatórios, Financeiro, LGPD). Header com logo e notificações; Footer com copyright.
3. **Execução de Consulta**: De /consulta/*, seleção de card → input de dados (CPF/CNPJ/placa) → validação → chamada API CORE → resultado exibido. Débito de créditos e registro em histórico.
4. **Gestão Pessoal**: De /relatorios/consultas, visualizar consumo; de /financeiro/*, gerenciar pagamentos e extratos.
5. **Logout**: Redirecionamento para login, limpeza de sessão.

### 4.2 Frontend-Admin
1. **Login/Redirecionamento**: Admin acessa admin.bigtech.com.br, autentica (role admin), redireciona para /.
2. **Navegação Principal**: Menu com seções para tenants, plugins, billing. Sidebar expansível.
3. **Gestão Operacional**: De /tenants, CRUD tenants; de /plugins, ativar plugins por tenant; de /billing, analisar consumo.
4. **Interações**: Modais para confirmações (ex.: desabilitar plugin), notificações para ações assíncronas (ex.: deploy plugin).
5. **Logout**: Similar ao user.

### 4.3 Fluxo Geral
- **Autenticação**: JWT via Appwrite, renovação automática.
- **Isolamento**: Todas as páginas filtram dados por tenantId (usuário) ou global (admin).
- **Plugins**: Páginas dinâmicas (ex.: consultas) ativam apenas se plugin relevante estiver enabled.
- **Responsividade**: Navegação adaptável (mobile/desktop), com hamburger menu.

## 5. Considerações de Design

- **Tecnologias**: Next.js para SSR/SSG, Tailwind CSS para estilos, Shadcn/UI para componentes. Temas via CSS variables (global.css, theme/dark.css, theme/light.css).
- **Acessibilidade**: Contraste alto, navegação por teclado, ARIA labels. Suporte a leitores de tela.
- **Responsividade**: Layouts fluidos, breakpoints para mobile/tablet/desktop.
- **Performance**: Lazy loading de componentes, otimização de imagens (Next.js Image), caching de dados (SWR).
- **Segurança**: Sanitização de inputs, proteção CSRF, rate limiting via middleware.
- **Extensibilidade**: Componentes reutilizáveis (Button, Card) em shared/, temas customizáveis por tenant (via Tenant.settings.theme). Detalhes de consultas (cards, preços) definidos em specs de plugins ou documento separado (ex.: 9.paginas.md).
- **UX**: Feedback visual (loaders, toasts), validação em tempo real, onboarding para novos usuários.

### 5.3.6 Dashboard Administrativo
O dashboard administrativo (/ no frontend-admin) exibe métricas globais e gráficos de uso para monitoramento da plataforma. Inclui:
- Gráficos de tenants ativos e consumo total via entidade Billing.
- Alertas de falhas/erros em tempo real.
- Links para gestão de tenants/plugins.
- Atualização automática de dados via polling/SWR.
- Tema dark/light aplicado conforme Tenant.settings.theme.

### 5.3.7 Gestão de Tenants
A página de gestão de tenants (/tenants no frontend-admin) permite CRUD completo:
- Lista de tenants com filtros por status/nome, paginação.
- Formulários para criação/edição (campos: name, status, plugins[]).
- Ações: Ativar/desativar tenant, visualizar detalhes (usuários, consumo).
- Validação: Isolamento visual, confirmações para ações críticas, unicidade de Tenant.name.
- Integração: Links para plugins/billing do tenant selecionado, logs de auditoria gerados para ações de CRUD (entidade Audit).

### 5.3.8 Gestão de Plugins
A página de gestão de plugins (/plugins no frontend-admin) gerencia plugins por tenant:
- Lista de plugins instalados/ativos, filtros por tenant/tipo.
- Toggles para enable/disable, configuração via modais (ex.: apiKey, fallbackSources).
- Validação de dependências (ex.: plugin de pagamento requerido para billing).
- Ações: Instalar novo plugin, atualizar versão, remover.
- Integração: Atualização automática de status via polling.

Observações de implementação (Docs-First):
- **Referência de Design System**: A UI deve seguir `8.DesignSystem.md` seção `6.9 Componentes para Gestão de Plugins` para padrões de `Plugin Table`, `Plugin Config Modal`, `Plugin Toggle` e feedback de operações.
- **Validação e dependências**: A interface deve bloquear ações que possam causar conflitos de dependência e exibir passos para resolução. O `pluginLoader` no CORE é responsável pela validação; a UI deve apresentar mensagens claras e permitir confirmação do administrador antes de ações que exijam deploy/restart.
- **Feedback e Auditoria**: Operações críticas (instalar, habilitar, desabilitar, remover, configurar) devem retornar e exibir um `Audit ID` (referência em `4.Entities.md`) no toast/modal de resultado, para rastreabilidade. Erros assíncronos devem expor `Audit ID` para investigações posteriores.
- **Restart/Deploy**: Se uma ação exigir restart de container ou deploy adicional, a UI deve avisar o administrador sobre o impacto e pedir confirmação explícita. A notificação de conclusão deve incluir link para o log/`Audit`.

### 5.3.9 Monitoramento de Billing
A página de monitoramento de billing (/billing no frontend-admin) exibe relatórios financeiros:
- Gráficos de receita/consumo por tenant/período.
- Lista de transações com filtros (tenant, usuário, status), exportação CSV/PDF.
- Alertas para falhas de pagamento ou consumo excessivo.
- Integração com plugins de pagamento para reembolsos manuais.
- Atualização: Dados em tempo real via SWR/polling.

Observações de implementação (Docs-First):
- **APIs Requeridas**: O backend deve expor endpoints paginados e autenticados para:
	- Listagem de transações (filtros: tenantId, userId, type, status, date range, externalTransactionId, pluginId)
	- Agregações por período (dia/semana/mês) e por tenant
	- Exportação consistente (CSV e PDF) que respeite exatamente os filtros aplicados
	- Operações administrativas: reembolso/manual-adjust, com retorno de `auditId` para rastreabilidade
- **Filtros e UX**: A UI precisa oferecer Date Range Picker, seleção de tenant (admin global), filtro por usuário, tipo de transação, status, plugin de pagamento, e busca por `externalTransactionId`.
- **Exportação e Consistência**: Exportações devem ser geradas no backend para garantir precisão e desempenho; o CSV deve conter colunas mínimas: `transactionId, tenantId, userId, type, amount, currency, status, processedAt, externalTransactionId, metadata`.
- **Alertas e Investigações**: Regras de alerta (ex.: picos de débito, múltiplas falhas de pagamento) devem aparecer na UI com link direto para a linha do `Audit` correspondente (usar `auditId`).
- **Performance**: Agregações pesadas devem ser atendidas por endpoints otimizados ou pré-computação (workers/cron) para relatórios históricos.

### 5.3.10 Auditoria de Ações
A página de auditoria (/audit no frontend-admin) permite visualizar logs de ações:
- Lista de logs com filtros por tenant/usuário/ação/período.
- Detalhes expandidos (resource, details, ipAddress).
- Exportação para compliance (CSV/JSON).
- Validação: Acesso restrito a admins, logs imutáveis.
- Integração: Busca avançada para investigações.

## 6. Histórico de Versões

- **Versão 1.5** (22 de dezembro de 2025): Atualização da seção 5.3.7 para incluir validação de unicidade de Tenant.name e geração de logs de auditoria para ações de CRUD, alinhando com US-009 e 4.Entities.md.
- **Versão 1.4** (22 de dezembro de 2025): Adição das seções 5.3.7 (Gestão de Tenants), 5.3.8 (Gestão de Plugins), 5.3.9 (Monitoramento de Billing) e 5.3.10 (Auditoria de Ações) para completar especificações de páginas administrativas.
- **Versão 1.3** (22 de dezembro de 2025): Adição da seção 5.3.6 detalhando o Dashboard Administrativo com métricas globais, gráficos e alertas.
- **Versão 1.2** (21 de dezembro de 2025): Detalhamento da página /financeiro/comprar como modelo pré-pago com input de valor, validação de mínimos/máximos configuráveis via admin, cálculo automático e componentes específicos.
- **Versão 1.1** (20 de dezembro de 2025): Refatoração baseada em 9.paginas.md. Atualização para consultas agrupadas por categoria (crédito, cadastral, veicular), adição de sidebar, header/footer, e novas páginas (relatórios, financeiro subdividido). Detalhes específicos de cards referenciados externamente para evitar poluição.