# Projeto Bigtech — Estrutura do Projeto

## Índice dos Documentos

- [1.Project.md](1.Project.md) - Visão geral do projeto
- [2.Architecture.md](2.Architecture.md) - Arquitetura técnica
- [3.Structure.md](3.Structure.md) - Estrutura do projeto
- [4.Entities.md](4.Entities.md) - Modelos de dados (entidades)
- [5.Pages.md](5.Pages.md) - Páginas e interfaces
- [6.UserStories.md](6.UserStories.md) - User Stories
- [7.Tasks.md](7.Tasks.md) - Tasks de implementação
- [8.DesignSystem.md](8.DesignSystem.md) - Design System

## 1. Visão Geral da Estrutura

A estrutura de diretórios e arquivos do Projeto Bigtech segue uma organização modular e escalável, alinhada com a arquitetura SaaS multi-tenant orientada a plugins. O projeto é dividido em frontends (usuário e admin), backend (CORE e plugins), infraestrutura e documentação. Cada componente é isolado para facilitar manutenção, deploy e isolamento por tenant via Docker.

- **Frontend-User**: Aplicação Next.js para usuários finais (consultas, compras).
- **Frontend-Admin**: Aplicação Next.js para administradores (gestão de tenants, plugins).
- **Backend**: Núcleo em Node.js/TypeScript com plugins, integrado ao Appwrite.
- **Infraestrutura**: Configurações Docker, Kubernetes e CI/CD.
- **Plugins**: Estrutura hierárquica por tipo e fonte (ex.: `plugins/consulta/infosimples`).
- **Estilos**: Sistema de temas com `global.css`, `theme/dark.css` e `theme/light.css`.

A estrutura suporta isolamento multi-tenant, onde cada tenant roda em um container Docker contendo CORE + plugins ativos.

## 1.1 Decisões Tecnológicas

- Frontend: Next.js (React), Shadecn, Tailwind CSS, Lucide Icons.
- Backend CORE/Plugins: Node.js/TypeScript.  
- BaaS: Appwrite.  
- Containers: Docker/Kubernetes.  
- Banco: MariaDB/PostgreSQL via Appwrite.  
- Comunicação: Event Bus (RabbitMQ).  
- Segurança: JWT, rate limiting, TLS, isolamento multi-tenant.

## 2. Estrutura de Diretórios e Arquivos

```
RAIZ/
├── Docs/                          # Documentação do projeto
│   ├── 0.Plan.md                  # Plano técnico inicial
│   ├── 1.Project.md               # Visão geral do projeto
│   ├── 2.Architecture.md          # Arquitetura técnica
│   └── 3.Structure.md             # Este documento
├── frontend-app/                 # Frontend para usuários (app.bigtech.com.br)
│   ├── src/
│   │   ├── components/            # Componentes reutilizáveis (React)
│   │   │   ├── Button.tsx
│   │   │   ├── Card.tsx
│   │   │   ├── Header.tsx         # Componente compartilhado (navegação superior)
│   │   │   ├── Footer.tsx         # Componente compartilhado (copyright e links)
│   │   │   └── ...
│   │   ├── pages/                 # Páginas Next.js (consultas, histórico, compras)
│   │   │   ├── index.tsx          # Página inicial (dashboard)
│   │   │   ├── consulta/          # Páginas de consulta por categoria
│   │   │   │   ├── credito.tsx    # Consultas de crédito
│   │   │   │   ├── cadastral.tsx  # Consultas cadastrais
│   │   │   │   └── veicular.tsx   # Consultas veiculares
│   │   │   ├── relatorios/        # Relatórios e histórico
│   │   │   │   └── consultas.tsx  # Relatório de consumo de consultas
│   │   │   ├── financeiro/        # Gestão financeira
│   │   │   │   ├── extrato.tsx    # Extrato financeiro
│   │   │   │   ├── comprar.tsx    # Compra de créditos
│   │   │   │   └── boletos.tsx    # Boletos e faturas
│   │   │   ├── lgpd.tsx           # Aviso LGPD
│   │   │   └── _app.tsx           # App wrapper
│   │   ├── styles/                # Estilos globais e temas
│   │   │   ├── global.css         # Estilos globais (reset, base)
│   │   │   ├── theme/
│   │   │   │   ├── dark.css       # Tema escuro
│   │   │   │   └── light.css      # Tema claro
│   │   │   └── index.css          # Imports de temas
│   │   ├── hooks/                 # Hooks customizados (React)
│   │   ├── utils/                 # Utilitários (helpers, constants)
│   │   └── lib/                   # Bibliotecas e integrações (Appwrite client)
│   ├── public/                    # Assets estáticos (imagens, icons)
│   ├── next.config.js             # Configuração Next.js
│   ├── package.json               # Dependências e scripts
│   ├── tsconfig.json              # Configuração TypeScript
│   ├── tailwind.config.js         # Configuração Tailwind CSS (se usado)
│   └── Dockerfile                 # Docker para build do frontend
├── frontend-admin/                # Frontend para administradores (admin.bigtech.com.br)
│   ├── src/
│   │   ├── components/            # Componentes admin (React)
│   │   │   ├── TenantManager.tsx
│   │   │   ├── PluginManager.tsx
│   │   │   └── ...
│   │   ├── pages/                 # Páginas Next.js (gestão)
│   │   │   ├── index.tsx          # Dashboard admin
│   │   │   ├── tenants.tsx        # Gestão de tenants
│   │   │   ├── plugins.tsx        # Ativação/desativação de plugins
│   │   │   ├── billing.tsx        # Monitoramento de consumo
│   │   │   ├── audit.tsx          # Auditoria de ações
│   │   │   └── _app.tsx           # App wrapper
│   │   ├── styles/                # Estilos (similar ao frontend-user)
│   │   │   ├── global.css
│   │   │   ├── theme/
│   │   │   │   ├── dark.css
│   │   │   │   └── light.css
│   │   │   └── index.css
│   │   ├── hooks/
│   │   ├── utils/
│   │   └── lib/
│   ├── public/
│   ├── next.config.js
│   ├── package.json
│   ├── tsconfig.json
│   ├── tailwind.config.js
│   └── Dockerfile
├── backend/                       # Backend CORE e plugins (Node.js/TypeScript)
│   ├── src/
│   │   ├── core/                  # Núcleo agnóstico
│   │   │   ├── auth.ts            # Autenticação (CPF/CNPJ)
│   │   │   ├── multiTenant.ts     # Gestão multi-tenant
│   │   │   ├── permissions.ts     # Controle de permissões
│   │   │   ├── pluginLoader.ts    # Carregamento de plugins
│   │   │   ├── eventBus.ts        # Comunicação assíncrona
│   │   │   ├── billingEngine.ts   # Billing genérico
│   │   │   ├── audit.ts           # Auditoria e logs
│   │   │   └── index.ts           # Ponto de entrada CORE
│   │   ├── plugins/               # Plugins extensíveis
│   │   │   ├── consulta/          # Plugins de consulta por fonte
│   │   │   │   ├── infosimples/   # Plugin consulta via Infosimples
│   │   │   │   │   ├── index.ts   # Implementação (consultas por categoria: crédito, cadastral, veicular)
│   │   │   │   │   ├── config.ts  # Configurações (fallback, custos)
│   │   │   │   │   └── types.ts   # Tipos específicos
│   │   │   │   ├── brasilapi/     # Plugin consulta via BrasilAPI
│   │   │   │   │   ├── index.ts
│   │   │   │   │   ├── config.ts
│   │   │   │   │   └── types.ts
│   │   │   │   └── ...            # Outras fontes (serasa, etc.)
│   │   │   ├── pagamentos/        # Plugins de pagamento
│   │   │   │   ├── asaas/         # Plugin Asaas
│   │   │   │   │   ├── index.ts
│   │   │   │   │   └── config.ts
│   │   │   │   ├── pagarme/       # Plugin Pagarme
│   │   │   │   │   └── ...
│   │   │   │   └── ...            # Outros (stripe, etc.)
│   │   │   ├── mercado/           # Plugins de mercado
│   │   │   │   ├── varejo/        # Plugin Varejo (padrão)
│   │   │   │   │   ├── index.ts
│   │   │   │   │   └── config.ts
│   │   │   │   └── atacado/       # Plugin Atacado (API pública)
│   │   │   │       ├── index.ts
│   │   │   │       ├── api.ts     # Exposição API
│   │   │   │       └── config.ts
│   │   │   └── funcionais/        # Plugins funcionais
│   │   │       ├── relatorios/    # Plugin Relatórios
│   │   │       │   └── index.ts
│   │   │       └── webhooks/      # Plugin Webhooks
│   │   │           └── index.ts
│   │   ├── api/                   # APIs Express.js (se necessário)
│   │   │   ├── routes.ts          # Rotas CORE
│   │   │   └── middleware.ts      # Middlewares (auth, rate limit)
│   │   ├── utils/                 # Utilitários compartilhados
│   │   └── lib/                   # Integrações (Appwrite SDK)
│   ├── package.json               # Dependências (express, appwrite, etc.)
│   ├── tsconfig.json              # TypeScript
│   ├── Dockerfile                 # Docker para backend
│   └── docker-compose.yml         # Compose para desenvolvimento
├── infrastructure/                # Infraestrutura e deploy
│   ├── docker/                    # Configs Docker
│   │   ├── Dockerfile.base        # Base para tenants
│   │   └── docker-compose.prod.yml # Produção
│   ├── k8s/                       # Kubernetes manifests
│   │   ├── deployment.yaml        # Deploy de containers
│   │   ├── service.yaml           # Serviços
│   │   └── ingress.yaml           # Ingress para frontends
│   ├── ci-cd/                     # Pipelines
│   │   ├── .github/workflows/     # GitHub Actions
│   │   │   ├── build.yml
│   │   │   └── deploy.yml
│   ├── monitoring/                # Monitoramento
│   │   ├── prometheus.yml         # Config Prometheus
│   │   ├── grafana/               # Dashboards Grafana
│   │   └── elk/                   # ELK Stack configs
│   └── scripts/                   # Scripts de deploy/backup
│       ├── deploy.sh
│       └── backup.sh
├── shared/                        # Código compartilhado (tipos, utils)
│   ├── types/                     # Tipos TypeScript globais
│   │   ├── plugin.ts              # Interface Plugin
│   │   └── tenant.ts              # Tipos Tenant
│   └── utils/                     # Helpers compartilhados
├── .gitignore                     # Git ignore
├── README.md                      # Documentação geral
├── package.json                   # Root package (monorepo, se usado)
└── docker-compose.yml             # Compose raiz para desenvolvimento
```

## 3. Descrições Detalhadas

- **Docs/**: Contém toda a documentação hierárquica (0.Plan.md a 9.DesignSystem.md), imutável e governando implementações.
- **Frontend-User/Admin**: Aplicações Next.js com SSR/SSG, focadas em UX. Estilos incluem temas dark/light para personalização.
- **Backend**: CORE mínimo em Node.js, com plugins modulares. Cada plugin segue contrato TypeScript, executado em containers isolados.
 - **Backend**: CORE mínimo em Node.js, com plugins modulares. Cada plugin segue contrato TypeScript, executado em containers isolados.
	- **Billing Engine & APIs**: O `backend/src/core/billingEngine.ts` e rotas correspondentes devem expor endpoints para: agregação por tenant/período, listagem de transações, exportação CSV/PDF, e operações administrativas (reembolso/manual adjustment). Essas APIs são consumidas pelo `frontend-admin` (página `/billing`).
- **Plugins**: Estrutura `plugins/tipo/fonte` (ex.: `consulta/infosimples`) para modularidade. Plugins são NPM packages ou módulos locais.
- **Infraestrutura**: Suporte a Docker/Kubernetes para isolamento multi-tenant. CI/CD automatizado.
 - **Infraestrutura**: Suporte a Docker/Kubernetes para isolamento multi-tenant. CI/CD automatizado.
	- **Observability**: Módulos de monitoramento (Prometheus/Grafana) devem coletar métricas do `billingEngine`, eventos do `Event Bus` e alertas configuráveis.
- **Shared**: Tipos e utils comuns para evitar duplicação entre frontends e backend.

Observação operacional: O frontend-admin contém componentes específicos de gestão de plugins (`PluginManager.tsx`) para listar, configurar e habilitar/desabilitar plugins por tenant. O backend CORE expõe o `pluginLoader` (em `backend/src/core/pluginLoader.ts`) responsável por ativação dinâmica, validação de dependências e emissão de eventos de auditoria. Siga a cadeia documental (1.Project → 2.Architecture → 4.Entities → 5.Pages → 8.DesignSystem) antes de alterações de implementação.

## 4. Considerações de Isolamento

Cada tenant roda um container Docker com CORE + plugins ativos, consumindo Appwrite isoladamente. Frontends são compartilhados mas autenticados por tenant.

## 5. Histórico de Versões

- **Versão 1.1** (20 de dezembro de 2025): Refatoração baseada em 5.Pages.md v1.1. Atualização da estrutura de páginas para consultas por categoria (crédito, cadastral, veicular), adição de novas pastas (relatorios/, financeiro/), e componentes compartilhados (Header, Footer).
- **Versão 1.0** (20 de dezembro de 2025): Criação inicial do documento 3.Structure.md baseado em 1.Project.md e 2.Architecture.md. Detalhamento da árvore de diretórios com foco em modularidade e isolamento.